<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="Vanessa McHale" />
  <title>Dickinson User Guide</title>
  <style>
    html {
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 12px;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      html {
        background-color: white;
      }
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    svg {
      height; auto;
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, Consolas, 'Lucida Console', monospace;
      font-size: 85%;
      margin: 0;
      hyphens: manual;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    /* The extra [class] is a hack that increases specificity enough to
       override a similar rule in reveal.js */
    ul.task-list[class]{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      font-size: inherit;
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<header id="title-block-header">
<h1 class="title">Dickinson User Guide</h1>
<p class="author">Vanessa McHale</p>
</header>
<nav id="TOC" role="doc-toc">
<ul>
<li><a href="#introduction" id="toc-introduction">Introduction</a></li>
<li><a href="#installing-dickinson"
id="toc-installing-dickinson">Installing Dickinson</a>
<ul>
<li><a href="#distributions"
id="toc-distributions">Distributions</a></li>
<li><a href="#source" id="toc-source">Source</a></li>
<li><a href="#editor-integration" id="toc-editor-integration">Editor
Integration</a>
<ul>
<li><a href="#tags" id="toc-tags">Tags</a></li>
</ul></li>
</ul></li>
<li><a href="#program-structure" id="toc-program-structure">Program
Structure</a>
<ul>
<li><a href="#example" id="toc-example">Example</a>
<ul>
<li><a href="#comments" id="toc-comments">Comments</a></li>
</ul></li>
<li><a href="#definitions-names" id="toc-definitions-names">Definitions
&amp; Names</a></li>
<li><a href="#branching" id="toc-branching">Branching</a></li>
<li><a href="#interpolation" id="toc-interpolation">Interpolation</a>
<ul>
<li><a href="#multi-line-strings" id="toc-multi-line-strings">Multi-Line
Strings</a></li>
</ul></li>
<li><a href="#expressions" id="toc-expressions">Expressions</a>
<ul>
<li><a href="#lambdas" id="toc-lambdas">Lambdas</a></li>
<li><a href="#matches-tuples" id="toc-matches-tuples">Matches &amp;
Tuples</a></li>
<li><a href="#tags-1" id="toc-tags-1">Tags</a></li>
</ul></li>
<li><a href="#types" id="toc-types">Types</a></li>
</ul></li>
<li><a href="#repl" id="toc-repl">REPL</a>
<ul>
<li><a href="#saving-restoring-states"
id="toc-saving-restoring-states">Saving &amp; Restoring States</a></li>
<li><a href="#builtins" id="toc-builtins">Builtins</a></li>
</ul></li>
<li><a href="#lints" id="toc-lints">Lints</a></li>
<li><a href="#libraries" id="toc-libraries">Libraries</a>
<ul>
<li><a href="#using-libraries" id="toc-using-libraries">Using
Libraries</a>
<ul>
<li><a href="#example-1" id="toc-example-1">Example</a></li>
<li><a href="#third-party-libraries"
id="toc-third-party-libraries">Third-Party Libraries</a></li>
</ul></li>
<li><a href="#writing-libraries" id="toc-writing-libraries">Writing
Libraries</a></li>
</ul></li>
<li><a href="#scripting" id="toc-scripting">Scripting</a></li>
<li><a href="#examples" id="toc-examples">Examples</a>
<ul>
<li><a href="#cowsay" id="toc-cowsay">Cowsay</a></li>
<li><a href="#noun-declension" id="toc-noun-declension">Noun
Declension</a></li>
<li><a href="#divination-bot" id="toc-divination-bot">Divination
Bot</a></li>
<li><a href="#star-wars-name-generator"
id="toc-star-wars-name-generator">Star Wars Name Generator</a></li>
<li><a href="#shakespearean-insult-generator"
id="toc-shakespearean-insult-generator">Shakespearean Insult
Generator</a></li>
<li><a href="#lyrics-bot" id="toc-lyrics-bot">Lyrics Bot</a></li>
<li><a href="#magical-realism-bot" id="toc-magical-realism-bot">Magical
Realism Bot</a></li>
</ul></li>
</ul>
</nav>
<h1 id="introduction">Introduction</h1>
<p>Dickinson is a text-generation language for generative literature.
Each time you run your code, you get back randomly generated text.</p>
<p>It provides a language to define random texts like the <a
href="https://twitter.com/MagicRealismBot">Magical Realism Bot</a> or <a
href="https://en.wikipedia.org/wiki/Fortune_%28Unix%29">fortune
program</a>.</p>
<h1 id="installing-dickinson">Installing Dickinson</h1>
<h2 id="distributions">Distributions</h2>
<p>Distributions for some platforms are available on the <a
href="https://github.com/vmchale/dickinson/releases">releases
page</a>.</p>
<p>Un-tar the package, then:</p>
<pre><code>make install</code></pre>
<h2 id="source">Source</h2>
<p>First, install <a
href="https://www.haskell.org/cabal/download.html">cabal</a> and <a
href="https://www.haskell.org/ghc/download.html">GHC</a>. Then:</p>
<pre><code>cabal install language-dickinson</code></pre>
<p>This provides <code>emd</code>, the command-line interface to the
Dickinson language.</p>
<p>You may also wish to install manpages for reference information about
<code>emd</code>. Manpages are installed at</p>
<pre><code>emd man</code></pre>
<h2 id="editor-integration">Editor Integration</h2>
<p>A <a href="https://github.com/vmchale/dickinson/tree/master/vim">vim
plugin</a> is available.</p>
<p>To install with <a
href="https://github.com/junegunn/vim-plug">vim-plug</a>:</p>
<pre class="vimscript"><code>Plug &#39;vmchale/dickinson&#39; , { &#39;rtp&#39; : &#39;vim&#39; }</code></pre>
<p>To automatically enable spellchecking where appropriate put</p>
<pre><code>autocmd BufNewFile,BufRead *.dck setlocal spell spelllang=en_us</code></pre>
<p>in your <code>~/.vimrc</code>.</p>
<h3 id="tags">Tags</h3>
<p>To configure Dickinson with <a
href="http://ctags.sourceforge.net/">exuberant ctags</a> or <a
href="https://ctags.io/">universal ctags</a>, put the following in a
file named <code>.ctags</code>:</p>
<pre><code>--langdef=DICKINSON
--langmap=DICKINSON:.dck
--regex-DICKINSON=/:def *([[:lower:]][[:alnum:]]+)/\1/f,function/
--regex-DICKINSON=/tydecl *([[:lower:]][[:alnum:]]+) *=/\1/t,type/</code></pre>
<p>I have the following in my <code>~/.vimrc</code> to keep tags
updated:</p>
<pre><code>augroup ctags
    autocmd BufWritePost *.dck :silent !ctags -R .
augroup END</code></pre>
<h1 id="program-structure">Program Structure</h1>
<p>Dickinson files begin with <code>%-</code>, followed by
definitions.</p>
<h2 id="example">Example</h2>
<p>Here is a simple Dickinson program:</p>
<pre><code>%-

(:def main
  (:oneof
    (| &quot;heads&quot;)
    (| &quot;tails&quot;)))</code></pre>
<p>Save this as <code>gambling.dck</code>. Then:</p>
<pre><code>emd run gambling.dck</code></pre>
<p>which will display either <code>heads</code> or
<code>tails</code>.</p>
<p>The <code>:oneof</code> construct selects one of its branches with
equal probability.</p>
<p>In general, when you <code>emd run</code> code, you’ll see the result
of evaluating <code>main</code>.</p>
<h3 id="comments">Comments</h3>
<p>Comments are indicated with a <code>;</code> at the beginning of the
line. Anything to the right of the <code>;</code> is ignored. So</p>
<pre><code>%-

; This returns one of &#39;heads&#39; or &#39;tails&#39;
(:def main
  (:oneof
    (| &quot;heads&quot;)
    (| &quot;tails&quot;)))</code></pre>
<p>is perfectly valid code and is functionally the same as the
above.</p>
<h2 id="definitions-names">Definitions &amp; Names</h2>
<p>We can define names and reference them later:</p>
<pre><code>%-

(:def gambling
  (:oneof
    (| &quot;heads&quot;)
    (| &quot;tails&quot;)))

(:def main
  gambling)</code></pre>
<p>We can <code>emd run</code> this and it will give the same results as
above.</p>
<h2 id="branching">Branching</h2>
<p>When you use <code>:oneof</code>, Dickinson picks one of the branches
with equal probability. If this is not what you want, you can use
<code>:branch</code>:</p>
<pre><code>%-

(:def unfairCoin
  (:branch
    (| 1.0 &quot;heads&quot;)
    (| 1.1 &quot;tails&quot;)))

(:def main
  unfairCoin)</code></pre>
<p>This will scale things so that picking <code>"tails"</code> is a
little more likely.</p>
<h2 id="interpolation">Interpolation</h2>
<p>We can recombine past definitions via string interpolation:</p>
<pre><code>%-

(:def adjective
  (:oneof
    (| &quot;beautiful&quot;)
    (| &quot;auspicious&quot;)
    (| &quot;cold&quot;)))

(:def main
  &quot;What a ${adjective}, ${adjective} day!&quot;)</code></pre>
<h3 id="multi-line-strings">Multi-Line Strings</h3>
<p>For large blocks of text, we can use multi-line strings.</p>
<pre><code>(:def twain
  &#39;&#39;&#39;
  Truth is the most valuable thing we have — so let us economize it.
    — Mark Twain
  &#39;&#39;&#39;)</code></pre>
<p>Multiline strings begin and end with <code>'''</code>.</p>
<h2 id="expressions">Expressions</h2>
<p>Branches, strings, and interpolations are expressions. A
<code>:def</code> can attach an expression to a name.</p>
<pre><code>%-

(:def color
  (:oneof
    (| &quot;yellow&quot;)
    (| &quot;blue&quot;)))

(:def adjective
  (:oneof
    (| &quot;beautiful&quot;)
    (| &quot;auspicious&quot;)
    (| color)))

(:def main
  &quot;What a ${adjective}, ${adjective} day!&quot;)</code></pre>
<p>Branches can contain any expression, including names that have been
defined previously (such as <code>color</code> in the example
above).</p>
<h3 id="lambdas">Lambdas</h3>
<p>Lambdas are how we introduce functions in Dickinson.</p>
<pre><code>(:def sayHello
  (:lambda name text
    &quot;Hello, ${name}.&quot;))</code></pre>
<p>Note that we have to specify the type of <code>name</code> - here, it
stands in for some string, so it is of type <code>text</code>.</p>
<p>We can use <code>sayHello</code> with <code>$</code> (pronounced
“apply”).</p>
<pre><code>(:def name
  (:oneof
    (| &quot;Alice&quot;)
    (| &quot;Bob&quot;)))

(:def main
  ($ sayHello name))</code></pre>
<p>We can <code>emd run</code> this:</p>
<pre><code>Hello, Bob.</code></pre>
<p><code>$ f x</code> corresponds to <code>f x</code> in ML.</p>
<h3 id="matches-tuples">Matches &amp; Tuples</h3>
<p>Suppose we want to randomly pick quotes. First we define a function
to return a quote by Fiona Apple:</p>
<pre><code>(:def fionaAppleQuote
  (:oneof
    (|
      &#39;&#39;&#39;
      &quot;You&#39;re more likely to get cut with a dull tool than a sharp one.&quot;
      &#39;&#39;&#39;)
    (|
      &#39;&#39;&#39;
      &quot;You forgot the difference between equanimity and passivity.&quot;
      &#39;&#39;&#39;)))</code></pre>
<p>Then we can define <code>quote</code>, which returns a quote as well
as the person who said it.</p>
<pre><code>(:def quote
  (:oneof
    (| (&quot;« Le beau est ce qu&#39;on désire sans vouloir le manger. »&quot;, &quot;Simone Weil&quot;))
    (| (fionaAppleQuote, &quot;Fiona Apple&quot;))))</code></pre>
<p>Each branch returns a tuple.</p>
<p>We can use the <code>:match</code> construct to format the result of
<code>quote</code>, viz.</p>
<pre><code>(:def formatQuote
  (:lambda q (text, text)
    (:match q
      [(quote, name)
        &#39;&#39;&#39;
        ${quote}
            — ${name}
        &#39;&#39;&#39;])))

(:def main
  $ formatQuote quote)</code></pre>
<p>We can <code>emd run</code> this:</p>
<pre><code>&quot;You forgot the difference between equanimity and passivity.&quot;
    — Fiona Apple</code></pre>
<p>Note the use of the <code>:lambda</code> in <code>formatQuote</code>;
we specify the type <code>(text, text)</code>.</p>
<h3 id="tags-1">Tags</h3>
<p>Tags can be used to split things based on cases.</p>
<pre><code>tydecl number = Singular | Plural

(:def indefiniteArticle
  (:lambda n number
    (:match n
      [Singular &quot;a&quot;]
      [Plural &quot;some&quot;])))</code></pre>
<p>Note that we specify the type <code>number</code> in
<code>(:lambda n number ...)</code>.</p>
<p>Tags themselves must begin with a capital letter while types begin
with a lowercase letter.</p>
<p>Tags are a restricted form of sum types.</p>
<h2 id="types">Types</h2>
<h1 id="repl">REPL</h1>
<p>To enter a REPL:</p>
<pre><code>emd repl</code></pre>
<p>This will show a prompt</p>
<pre><code>emd&gt;</code></pre>
<p>If we have</p>
<pre><code>%-

(:def gambling
  (:oneof
    (| &quot;heads&quot;)
    (| &quot;tails&quot;)))</code></pre>
<p>in a file <code>gambling.dck</code> as above, we can load it with</p>
<pre><code>emd&gt; :l gambling.dck</code></pre>
<p>We can then evaluate <code>gambling</code> if we like</p>
<pre><code>emd&gt; gambling</code></pre>
<p>or manipulate names that are in scope like so:</p>
<pre><code>emd&gt; &quot;The result of the coin toss is: ${gambling}&quot;</code></pre>
<p>We can also create new definitions:</p>
<pre><code>emd&gt; (:def announcer &quot;RESULT: ${gambling}&quot;)
emd&gt; announcer</code></pre>
<p>Inspect the type of an expression with <code>:type</code>:</p>
<pre><code>emd&gt; :type announcer
text</code></pre>
<p>We can define types in the REPL:</p>
<pre><code>emd&gt; tydecl case = Nominative | Oblique | Possessive
emd&gt; :type Nominative
case</code></pre>
<h2 id="saving-restoring-states">Saving &amp; Restoring States</h2>
<p>We can save the REPL state, including any definitions we’ve declared
during the session.</p>
<pre><code>emd&gt; :save replSt.emdi</code></pre>
<p>If we exit the session we can restore the save definitions with</p>
<pre><code>emd&gt; :r replSt.emdi
emd&gt; announcer</code></pre>
<p>For reference information about the Dickinson REPL:</p>
<pre><code>:help</code></pre>
<h2 id="builtins">Builtins</h2>
<p>Dickinson has several builtin functions. You can see all names in
scope (including builtins) with <code>:list</code>, viz.</p>
<pre><code>emd&gt; :list
oulipo
allCaps
capitalize
titleCase</code></pre>
<p>We can inspect the type like defined names:</p>
<pre><code>emd&gt; :type allCaps
(-&gt; text text)</code></pre>
<p>Try it out:</p>
<pre><code>emd&gt; $ allCaps &quot;Guilt and self-laceration are indulgences&quot;
GUILT AND SELF-LACERATION ARE INDULGENCES</code></pre>
<h1 id="lints">Lints</h1>
<p><code>emd</code> has a linter which can make suggestions based on
probable mistakes. We can invoke it with <code>emd lint</code>:</p>
<pre><code>emd lint silly.dck</code></pre>
<h1 id="libraries">Libraries</h1>
<p>Dickinson allows pulling in definitions from other files with
<code>:include</code>.</p>
<h2 id="using-libraries">Using Libraries</h2>
<h3 id="example-1">Example</h3>
<p>The <code>color</code> module is bundled by default:</p>
<pre><code>(:include color)

%-

(:def main
  &quot;Today&#39;s mood is ${color}&quot;)</code></pre>
<p>Which gives:</p>
<pre><code>Today&#39;s mood is citron</code></pre>
<p>The <code>:include</code> must come before the <code>%-</code>;
definitions come after the <code>%-</code>.</p>
<p><code>color.dck</code> contains:</p>
<pre><code>%-

(:def color
  (:oneof
    (| &quot;aubergine&quot;)
    (| &quot;cerulean&quot;)
    (| &quot;azure&quot;)
    ...</code></pre>
<h3 id="third-party-libraries">Third-Party Libraries</h3>
<p>Upon encountering <code>:include animals.mammal</code>, Dickinson
looks for a file <code>animals/mammal.dck</code>.</p>
<p>When invoking <code>emd</code>, we can use the <code>--include</code>
flag to add directories to search.</p>
<h2 id="writing-libraries">Writing Libraries</h2>
<p>Libraries can contain definitions and type declarations.</p>
<p>You can run <code>emd check</code> on a library file to validate
it.</p>
<h1 id="scripting">Scripting</h1>
<p><code>emd</code> ignores any lines staring with <code>#!</code>;
put</p>
<pre><code>#!/usr/bin/env emd</code></pre>
<p>and the top of a file to use <code>emd</code> as an interpreter. As
an example, here is an implementation of the Unix fortune program as a
script:</p>
<pre><code>#!/usr/bin/env emd

%-

(:def adjective
  (:oneof
    (| &quot;good&quot;)
    (| &quot;bad&quot;)))

(:def main
  &quot;You will have a ${adjective} day&quot;)</code></pre>
<h1 id="examples">Examples</h1>
<h2 id="cowsay">Cowsay</h2>
<p>Here is a variation on cowsay:</p>
<pre><code>(:def cowsay
  (:lambda txt text
    &#39;&#39;&#39;

    ${txt}
    ------
          \   ^__^
           \  (oo)\_______
              (__)\       )\/\
                  ||----w |
                  ||     ||
    &#39;&#39;&#39;))</code></pre>
<h2 id="noun-declension">Noun Declension</h2>
<p>We can use tuples and tags to model nouns and noun declension.</p>
<pre><code>tydecl case = Nominative | Accusative | Dative | Genitive | Instrumental

tydecl gender = Masculine | Feminine | Neuter

tydecl number = Singular | Plural

; demonstrative pronouns
; &quot;this&quot; or &quot;these&quot;
(:def decline
  (:lambda x (case, gender, number)
    (:match x
      [(Nominative, Masculine, Singular) &quot;þes&quot;]
      [(Accusative, Masculine, Singular) &quot;þisne&quot;]
      [(Genitive, (Masculine|Neuter), Singular) &quot;þisses&quot;]
      [(Dative, (Masculine|Neuter), Singular) &quot;þissum&quot;]
      [(Instrumental, (Masculine|Neuter), Singular) &quot;þys&quot;]
      [((Nominative|Accusative), Neuter, Singular) &quot;þis&quot;]
      [(Nominative, Feminine, Singular) &quot;þeos&quot;]
      [(Accusative, Feminine, Singular) &quot;þas&quot;]
      [((Genitive|Dative|Instrumental), Feminine, Singular) &quot;þisse&quot;]
      [((Nominative|Accusative), _, Plural) &quot;þas&quot;]
      [(Genitive, _, Plural) &quot;þissa&quot;]
      [(Dative, _, Plural) &quot;þissum&quot;]
      )))</code></pre>
<p>In the REPL:</p>
<pre><code>emd&gt; $ decline (Nominative, Feminine, Singular)
þeos</code></pre>
<p>This actually has no element of randomness but such capabilities are
important for agreement in longer generative texts.</p>
<p>For guidance:</p>
<pre><code>emd&gt; :type decline
(-&gt; (case, gender, number) text)</code></pre>
<h2 id="divination-bot">Divination Bot</h2>
<p>This is a more sophisticated version of Maja Bäckvall’s <a
href="https://twitter.com/botmancy">divination bot</a>. The novelty is
that by using tags, we get agreement between the Greek root and the
definition.</p>
<pre><code>%-

tydecl means = Fish
             | Stars
             | Snakes
             | Sun
             | Animals
             | Lips
             | Dreams
             | Placenta
             | Poo
             | Fingers
             | Number
             ...

(:def prefix
  (:lambda x means
    (:match x
      [Fish &quot;ichthyo&quot;]
      [Stars &quot;astro&quot;]
      [Snakes &quot;ophio&quot;]
      [Sun &quot;helio&quot;]
      [Animals &quot;zoo&quot;]
      [Lips &quot;labio&quot;]
      [Dreams &quot;oneiro&quot;]
      [Placenta &quot;amnio&quot;]
      [Poo &quot;scato&quot;]
      [Fingers &quot;dactylo&quot;]
      [Number &quot;numero&quot;]
      ...
      )))

(:def english
  (:lambda x means
    (:match x
      [Fish &quot;fish&quot;]
      [Stars &quot;stars&quot;]
      [Birds &quot;birds&quot;]
      [Snakes &quot;snakes&quot;]
      [Sun &quot;sun&quot;]
      [Animals &quot;animals&quot;]
      [Lips &quot;lips&quot;]
      [Dreams &quot;dreams&quot;]
      [Placenta &quot;placenta&quot;]
      [Poo &quot;excrement&quot;]
      [Fingers &quot;finger movements&quot;]
      [Number &quot;numbers&quot;]
      ...
      )))

(:def means
  (:pick means))

(:def postfix
  (:branch
    (| 1.0 &quot;mancy&quot;)
    (| 0.065 &quot;scopy&quot;)
    (| 0.03 &quot;spication&quot;)
    (| 0.06 &quot;logy&quot;)))

(:def main
  (:bind
    [means means]
      &quot;${$prefix means}${postfix} - divination by ${$english means}&quot;))</code></pre>
<p><code>:pick</code> is a builtin construct which randomly selects a
tag of type <code>means</code>.</p>
<p>Note also <code>:bind</code> in place of <code>:let</code> — this
construct resolves all randomness before bringing <code>means</code>
into scope.</p>
<p>So the Tracery bot might produce</p>
<pre><code>uranospication

Divination using the appearance of proper names.</code></pre>
<p>but ours produces results like</p>
<pre><code>amniomancy - divination by placenta</code></pre>
<p>We’ve also weighted <code>postfix</code> so that the more common
suffixes (such as ‘-mancy’) occur more often.</p>
<p>See the full example in <code>examples/divinationBot.dck</code></p>
<h2 id="star-wars-name-generator">Star Wars Name Generator</h2>
<p>As an example, consider a Star Wars name generator:</p>
<pre><code>%-

(:def main
  (:let
    [either
      (:oneof
        (| &quot;Quarrel&quot;)
        (| &quot;Vult&quot;)
        ...
        (| &quot;Blot&quot;))]
    (:let
      [firstname
        (:oneof
          (| &quot;Yert&quot;)
          (| &quot;Wam&quot;)
          (| &quot;Pommet&quot;)
          ...
          (| either))]
      [lastname
        (:oneof
          (| &quot;Grinell&quot;)
          (| &quot;Gorpax&quot;)
          ...
          (| either))]
      &quot;${(:flatten firstname)} ${(:flatten lastname)}&quot;)))</code></pre>
<p>The <code>:flatten</code> builtin makes all child outcomes equally
likely. So <code>(:flatten firstname)</code> will sample “Quarrel”,
“Yert” with equal probability.</p>
<p>See the full example in <code>examples/starwars.dck</code></p>
<h2 id="shakespearean-insult-generator">Shakespearean Insult
Generator</h2>
<p>Inspired by the <a
href="http://web.mit.edu/dryfoo/Funny-pages/shakespeare-insult-kit.html">Shakespeare
Insult Kit</a>’s insult table, we can generate our own insults.</p>
<pre><code>%-

(:def adjective
  (:oneof
    (| &quot;artless&quot;)
    (| &quot;base-court&quot;)
    (| &quot;bawdy&quot;)
    (| &quot;bat-fowling&quot;)
    ...

(:def noun
  (:oneof
    (| &quot;apple-john&quot;)
    (| &quot;baggage&quot;)
    (| &quot;barnacle&quot;)
    (| &quot;bladder&quot;)
    ...

(:def main
  (&quot;Thou ${adjective} ${adjective} ${noun}!&quot;))</code></pre>
<p>Run it get something like:</p>
<pre><code>Thou beslubbering clouted hedge-pig!</code></pre>
<p>See the full example in <code>examples/shakespeare.dck</code>.</p>
<h2 id="lyrics-bot">Lyrics Bot</h2>
<p>Lyrics bots sample lyrics from some particular artist; see the <a
href="https://twitter.com/africabytotobot">africa by toto bot</a> for an
example.</p>
<p>We can make our own Fiona Apple bot, viz.</p>
<pre><code>%-

(:def fiona
  (:oneof
    (| &quot;You forgot the difference between equanimity and passivity.&quot;)
    (| &quot;You&#39;re more likely to get cut with a dull tool than a sharp one.&quot;)
    (| &quot;The child is gone.&quot;)
    (|
      &#39;&#39;&#39;
      Oh darling, it&#39;s so sweet
      You think you know how crazy, how crazy I am.
      &#39;&#39;&#39;)
    ...

(:def main
  fiona)</code></pre>
<p>See the full example in <code>examples/fionaBot.dck</code></p>
<h2 id="magical-realism-bot">Magical Realism Bot</h2>
<p>We can write our own magical realism bot using builtin libraries:</p>
<pre><code>(:include profession)
(:include geography)

%-

(:def main
  (:oneof
    (|
      (:let
        [accomplishment
          (:oneof
            (|
              (:let
                [txt
                  (:oneof
                    (| &quot;Excel spreadsheet&quot;)
                    (| &quot;palimpsest&quot;))]
                [power
                  (:oneof
                    (| &quot;comfort animals&quot;)
                    (| &quot;practice bilocation&quot;))]
                (:oneof
                  (| &quot;discovers a ${txt} that allows her to ${power}&quot;))))
            (|
              (:let
                [topic
                  (:oneof
                    (| &quot;balneology&quot;)
                    (| &quot;teleology&quot;)
                    (| &quot;nephrology&quot;)
                    (| &quot;orgonomy&quot;))]
                &quot;writes a monograph on ${topic}&quot;))
            (|
              (:let
                [secret
                  (:oneof
                    (| &quot;immortality&quot;)
                    (| &quot;heliophagy&quot;)
                    (| &quot;levitation&quot;)
                    (| &quot;good skin&quot;))]
              &quot;discovers the secret to ${secret}&quot;)
          ))]
      &quot;A ${profession} in ${bigCity} ${accomplishment}&quot;))))</code></pre>
<p>This reuses the <code>bigCity</code> definition from the
<code>geography</code> library and <code>profession</code> from the
<code>profesion</code> library.</p>
<p>This is not as sophisticated as the <a
href="https://twitter.com/MagicRealismBot">twitter bot</a> but it is
quite concise thanks to the libraries we used.</p>
</body>
</html>
